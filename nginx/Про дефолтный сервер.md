# `default_server`

> [1] - https://qna.habr.com/q/481490

Если не сделать ___дефолтную конфигу___ (которая будет отвечать на все запросы, которые не попадают под остальные виртуальные хосты), то сайт, который должен висеть ___ТОЛЬКО___ на `acme.bubbles-averin.ru` будет висеть и на `IP`, и на всех остальных поддоменах.

Чтобы этого говна избежать, надо просто добавить виртуальный хост, который будет всех слать нахуй, если оно не попадает к какому-то определенному виртуальному хосту.

Идеальный универсальный темлпейт:
> Серт вообще любой, оно ниче отдавать не будет
```bash
server {
    listen 80 default_server;
    server_name _;
    return 444;
}
server {
    listen 443 ssl default_server;
    server_name _;
    add_header Strict-Transport-Security 'max-age=31536000';
    return 444;
    ssl_certificate /etc/nginx/ssl/acme.bubbles-averin.ru_P256/fullchain.cer;
    ssl_certificate_key /etc/nginx/ssl/acme.bubbles-averin.ru_P256/private.key;
}
```

Интересности:
 - `444` код ошибки у Nginx'а, когда он просто закрыл соединение без каких-либо объяснений. Снижает нагрузку, типа вот оптимизированно и тыры пырыю
 - Cтрока в ssl выглядела изначально как `listen 443 ssl http2 default_server;`. Если смотреть такой сайт в хроме, то он не просто говорит что нет ответа, а именно обсирается и орет, что там ошибка с `http2`. Неизвестно надо ли это, но оно было.